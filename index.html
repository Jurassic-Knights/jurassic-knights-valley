<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Jurassic Knights: Valley - A 2D video game">
    <title>Jurassic Knights: Valley</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components-buttons.css">
    <link rel="stylesheet" href="css/components-cards.css">
    <link rel="stylesheet" href="css/components-utilities.css">
    <link rel="stylesheet" href="css/components-forge.css">
    <link rel="stylesheet" href="css/vfx.css">
    <link rel="stylesheet" href="css/ui-hud-core.css">
    <link rel="stylesheet" href="css/ui-hud-resources.css">
    <link rel="stylesheet" href="css/ui-hud-quest.css">
    <link rel="stylesheet" href="css/ui-hud-gauges.css">
    <link rel="stylesheet" href="css/ui-hud-footer.css">
    <link rel="stylesheet" href="css/ui-hud-loading.css">
    <link rel="stylesheet" href="css/ui-hud-modals.css">
    <link rel="stylesheet" href="css/ui-hud-inventory.css">
    <link rel="stylesheet" href="css/ui-hud-unlock.css">
    <link rel="stylesheet" href="css/ui-hud-merchant.css">
    <link rel="stylesheet" href="css/ui-capture.css"> <!-- Debug: UI Capture Mode -->
    <link rel="stylesheet" href="src/css/equipment-screen.css">
    <link rel="stylesheet" href="css/ui-hud-weaponwheel.css">
    <link rel="stylesheet" href="css/debug.css">

    <!-- Utilities -->
    <script type="module" src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>

<body class="has-cheat-bar">
    <!-- Debug Cheat Bar (outside game container) -->
    <div id="cheat-bar">
        <div class="cheat-control">
            <label>Platform:</label>
            <button id="cheat-mobile">Mobile</button>
            <button id="cheat-pc">PC</button>
            <button onclick="window.debugUICapture()">UI Capture</button>
            <button onclick="window.TextureAligner.toggle()">Align Textures</button>
        </div>
        <div class="cheat-separator"></div>
        <div class="cheat-control">
            <label>Time:</label>
            <select id="cheat-time">
                <option value="auto">Auto</option>
                <option value="dawn">Dawn</option>
                <option value="day">Day</option>
                <option value="dusk">Dusk</option>
                <option value="night">Night</option>
            </select>
        </div>
        <div class="cheat-control">
            <label>Season:</label>
            <select id="cheat-season">
                <option value="auto">Auto</option>
                <option value="SPRING">Spring</option>
                <option value="SUMMER">Summer</option>
                <option value="AUTUMN">Autumn</option>
                <option value="WINTER">Winter</option>
            </select>
        </div>
        <div class="cheat-control">
            <label>Weather:</label>
            <select id="cheat-weather">
                <option value="auto">Auto</option>
                <option value="CLEAR">Clear</option>
                <option value="RAIN">Rain</option>
                <option value="STORM">Storm</option>

                <option value="SNOW">Snow</option>
            </select>
        </div>
        <div class="cheat-separator"></div>
    </div>

    <div id="app">
        <!-- Game Canvas Container -->
        <div id="game-container">
            <canvas id="game-canvas"></canvas>
            <!-- VFX Canvases (layered inside container) -->
            <canvas id="vfx-canvas"></canvas>
            <canvas id="vfx-canvas-fg"></canvas>
        </div>

        <!-- Virtual Joystick (mobile only) -->
        <div id="joystick-area">
            <div id="joystick-base"></div>
            <div id="joystick-knob"></div>
        </div>

        <!-- UI OVERLAY -->
        <div id="ui-overlay">

            <!-- ZONE 1: HEADER (Top Bar + Quest) -->
            <div id="ui-header-zone">
                <!-- Simplified Resource Counters -->
                <div id="resource-counters">
                    <div class="resource-counter">
                        <div class="counter-icon" data-icon-id="ui_icon_gold"></div>
                        <span class="counter-value" id="res-gold">0</span>
                    </div>
                    <div class="resource-counter">
                        <div class="counter-icon" data-icon-id="ui_icon_gem"></div>
                        <span class="counter-value" id="res-gem">0</span>
                    </div>
                    <div class="resource-counter">
                        <div class="counter-icon" data-icon-id="ui_icon_token"></div>
                        <span class="counter-value" id="res-token">0</span>
                    </div>
                </div>


                <!-- ZONE 2: BODY (Side HUDs & Quest) -->
                <div id="ui-body-zone">
                    <!-- Left Side HUD (Character Status) - "Field Gauges" -->
                    <div id="ui-hud-left">
                        <div class="character-frame">
                            <div class="character-avatar" data-icon-id="ui_avatar_knight"></div>
                            <div class="character-rank">SQR</div>
                        </div>
                        <div class="status-gauges">
                            <div class="gauge health-gauge">
                                <div class="gauge-label">VIT</div>
                                <div class="gauge-track">
                                    <div class="gauge-fill" id="health-bar" style="width: 100%"></div>
                                </div>
                                <span class="gauge-value" id="health-text">100</span>
                            </div>
                            <div class="gauge stamina-gauge">
                                <div class="gauge-label">RES</div>
                                <div class="gauge-track">
                                    <div class="gauge-fill" id="stamina-bar" style="width: 100%"></div>
                                </div>
                                <span class="gauge-value" id="stamina-text">100</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quest Panel + Resolve Bar Container -->
                    <div id="quest-resolve-container">
                        <!-- Quest Panel -->
                        <div id="ui-quest-panel">
                            <div class="quest-frame">
                                <div class="quest-header">
                                    <span class="header-label">TRANSMISSION</span>
                                    <span class="header-id">ORD-001</span>
                                </div>
                                <div class="quest-content">
                                    <div class="quest-icon" data-icon-id="ui_icon_orders"></div>
                                    <div class="quest-text">
                                        <span class="quest-objective" id="quest-description">Gather 5 Scrap Metal</span>
                                        <div class="quest-progress">
                                            <div class="progress-bar">
                                                <div class="progress-fill" id="quest-progress-bar" style="width: 0%">
                                                </div>
                                            </div>
                                            <span class="progress-text" id="quest-progress">(0/5)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Resolve Bar -->
                        <div id="ui-resolve-bar">
                            <div class="resolve-fill" id="resolve-fill"></div>
                            <span class="resolve-text" id="resolve-text">100 / 100</span>
                        </div>
                    </div>

                    <!-- Right Side HUD (Actions) - "Equipment Console" -->
                    <div id="ui-hud-right">
                        <!-- Docked Panels will appear here -->
                    </div>
                </div>
            </div>

            <!-- ZONE 3: FOOTER - Fancy Action Bar -->
            <div id="ui-footer-zone">
                <!-- Decorative Footer Bar -->
                <div class="footer-bar">
                    <div class="footer-wing left"></div>
                    <div class="footer-center"></div>
                    <div class="footer-wing right"></div>
                </div>

                <!-- Button Row -->
                <div class="footer-buttons">
                    <!-- Left Group -->
                    <div class="button-group left">
                        <button class="action-btn" id="btn-inventory" title="Field Kit">
                            <div class="btn-icon" data-icon-id="ui_icon_inventory"></div>
                            <span class="btn-label text-pixel-outline">KIT</span>
                        </button>
                        <button class="action-btn" id="btn-equip" title="Equipment">
                            <div class="btn-icon" data-icon-id="ui_icon_armor"></div>
                            <span class="btn-label text-pixel-outline">EQUIP</span>
                        </button>
                    </div>

                    <!-- Center Slot (Context Action) - Always Reserved -->
                    <div class="center-slot">
                        <div class="center-pedestal"></div>
                        <button class="action-btn context-btn" id="btn-context-action">
                            <div class="btn-icon" id="context-icon"></div>
                            <span class="btn-label text-pixel-outline" id="context-label">---</span>
                        </button>
                    </div>

                    <!-- Right Group -->
                    <div class="button-group right">
                        <button class="action-btn" id="btn-map" title="Sector Map">
                            <div class="btn-icon" data-icon-id="ui_icon_map"></div>
                            <span class="btn-label text-pixel-outline">MAP</span>
                        </button>
                        <button class="action-btn" id="btn-magnet" title="Magnet Protocol">
                            <div class="btn-icon" data-icon-id="ui_icon_magnet"></div>
                            <span class="btn-label text-pixel-outline">MAG</span>
                        </button>
                    </div>
                </div>
            </div>


            <!-- MODALS -->
            <div id="modal-layer">
                <!-- Inventory Modal -->
                <div id="modal-inventory" class="modal-panel" style="display: none;">
                    <div class="modal-header">
                        <span class="modal-title">FIELD KIT</span>
                        <button class="modal-close" id="btn-close-inventory">X</button>
                    </div>
                    <div class="modal-body">
                        <div id="inventory-grid" class="inventory-grid">
                            <!-- Items injected by JS -->
                        </div>
                    </div>
                </div>

                <!-- Merchant Modal -->
                <div id="modal-merchant" class="modal-panel" style="display: none;">
                    <div class="modal-header">
                        <span class="modal-title" id="merchant-title">MERCHANT</span>
                        <button class="modal-close" id="btn-close-merchant">X</button>
                    </div>
                    <div class="modal-body">
                        <div class="upgrade-list">
                            <div class="upgrade-row">
                                <div class="upgrade-info">
                                    <span class="upgrade-label">Resource Slots</span>
                                    <span class="upgrade-level" id="upgrade-resourceSlots-level">3/15 nodes</span>
                                </div>
                                <button class="upgrade-btn" id="btn-upgrade-resourceSlots">
                                    <span class="upgrade-cost" id="upgrade-resourceSlots-cost">100 Gold</span>
                                </button>
                            </div>
                            <div class="upgrade-row">
                                <div class="upgrade-info">
                                    <span class="upgrade-label">Auto Collect</span>
                                    <span class="upgrade-level" id="upgrade-autoChance-level">0/80 %</span>
                                </div>
                                <button class="upgrade-btn" id="btn-upgrade-autoChance">
                                    <span class="upgrade-cost" id="upgrade-autoChance-cost">150 Gold</span>
                                </button>
                            </div>
                            <div class="upgrade-row">
                                <div class="upgrade-info">
                                    <span class="upgrade-label">Production Speed</span>
                                    <span class="upgrade-level" id="upgrade-respawnTime-level">1/100 lvl</span>
                                </div>
                                <button class="upgrade-btn" id="btn-upgrade-respawnTime">
                                    <span class="upgrade-cost" id="upgrade-respawnTime-cost">75 Gold</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Forge Modal -->
                <div id="modal-forge" class="modal-panel" style="display: none;">
                    <div class="modal-header">
                        <span class="modal-title" style="color: #F39C12;">BATTLE FORGE</span>
                        <button class="modal-close" id="btn-close-forge">X</button>
                    </div>
                    <div class="modal-body">
                        <div class="forge-grid">
                            <div style="text-align: center; padding: 20px;">
                                Forge Systems Offline<br>
                                <span style="font-size: 0.8em;">(Crafting Coming Soon)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map Modal -->
                <div id="modal-map" class="modal-panel" style="display: none;">
                    <div class="modal-header">
                        <span class="modal-title" style="color: #3498DB;">SECTOR MAP</span>
                        <button class="modal-close" id="btn-close-map">X</button>
                    </div>
                    <div class="modal-body" style="padding: 10px;">
                        <canvas id="minimap-canvas" width="400" height="400"
                            style="display: block; margin: 0 auto; background: #1a1a2e; border: 2px solid #333;"></canvas>
                        <div style="text-align: center; margin-top: 10px; font-size: 12px; color: #888;">
                            <span style="color: #4CAF50;">●</span> Home &nbsp;
                            <span style="color: #2196F3;">●</span> Unlocked &nbsp;
                            <span style="color: #555;">●</span> Locked &nbsp;
                            <span style="color: #FF5722;">▲</span> You
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Cinematic Overlay -->
        <div id="fade-overlay"></div>

        <!-- Weapon Set Swap Button (floating, outside ui-overlay) -->
        <button class="floating-swap-btn" id="btn-weapon-swap" title="Swap Weapon Set">
            <div class="btn-icon-mini" data-icon-id="ui_icon_swap"></div>
        </button>

        <!-- Loading Screen -->
        <div id="loading">
            <p>DEPLOYING TO SECTOR...</p>
            <div class="loading-bar">
                <div class="loading-bar-fill"></div>
            </div>
        </div>
    </div>
    <!-- Single Entry Point - All modules bundled by Vite -->
    <script type="module" src="/src/main.ts"></script>
</body>

</html>